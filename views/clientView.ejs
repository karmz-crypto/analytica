<div class="container my-2">
    <li class="list-group-item list-group-item-primary">Clients</li>
</div><!--div clo-->

<div class="container">
    <ul class="nav">
        <li class="nav-item">
          <a class="nav-link" aria-current="page" href="/clients/addClientsForm">Add</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">Delete</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">Update</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="#">View</a>
        </li>
      </ul><hr>
</div> <!--div close-->

<div class="container my-1">
    <div class="input-group mb-3">        
        <select class="form-select" id="inputGroupSelect03" name="clientId" aria-label="Example select with button addon">
          <option selected>Select Client</option>
          <% clients.forEach((element)=>{ %>
          <option value="<%=element._id%>"><%=element.clientName%></option>
          <%})%>
        </select>
        <button class="btn btn-outline-primary"  type="button">Search For Client</button>
    </div>
</div><!--div close-->

<div class="container my-2 p-2">
    <div class="col-xl-8 col-lg-8 col-md-8 col-sm-12 my-2 p-2">
        <ul class="list-group">
            <li class="list-group-item list-group-item-primary my-1">
                Clients List With Transactions
            </li>
            <% if(clients.length===0){%>
            <li class="list-group-item list-group-item-dark my-1">
                No Clients Present
            </li>
            <%} var i=0;%>
            <% clients.forEach(element=>{ %>
                <% if(element.purchaseProduct.length!==0 || element.salesProduct.length!==0 || element.payments.length!==0){ %>

            <div class="accordion" id="accordionExample<%=i%>">
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingOne<%=i%>">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne<%=i%>" aria-expanded="true" aria-controls="collapseOne<%=i%>">
                        <span class="text-capitalize"><%=element.clientName%></span>
                        </button>
                    </h2>
                    <div id="collapseOne<%=i%>" class="accordion-collapse collapse show" aria-labelledby="headingOne<%=i%>" data-bs-parent="#accordionExample<%=i%>">
                        <div class="accordion-body">

                            <ul class="nav wideViewIndex">
                                <li class="nav-item">
                                <a class="nav-link" aria-current="page" href="#">Add</a>
                                </li>
                                <li class="nav-item">
                                <a class="nav-link" href="#">Delete</a>
                                </li>
                                <li class="nav-item">
                                <a class="nav-link" href="#">Update</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="#">View</a>
                                </li>
                            </ul>
                                    <!--mobile view display-->
                            <ul class="nav mobileViewIndex">
                                <li class="nav-item">
                                    <!--add will add purchase/sales/payment-->
                                <a class="nav-link" aria-current="page" href="#"><!--Add-->
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-plus-lg" viewBox="0 0 16 16">
                                        <path d="M8 0a1 1 0 0 1 1 1v6h6a1 1 0 1 1 0 2H9v6a1 1 0 1 1-2 0V9H1a1 1 0 0 1 0-2h6V1a1 1 0 0 1 1-1z"/>
                                    </svg>
                                </a>
                                </li>
                                <li class="nav-item"><!--delete will delete client/this.purchase/this.payment/this.sales-->
                                <a class="nav-link" href="#"><!--Delete-->
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16">
                                        <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>
                                        <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>
                                    </svg>
                                </a>
                                </li>
                                <li class="nav-item"><!--update will update client info/purchase info/saleinfo/payemnet info-->
                                <a class="nav-link" href="#"><!--Update-->
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-subtract" viewBox="0 0 16 16">
                                        <path d="M0 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v2h2a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2v-2H2a2 2 0 0 1-2-2V2zm2-1a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H2z"/>
                                    </svg>
                                </a>
                                </li>
                                <li class="nav-item"><!--view will open the client page with all the transactions in it -->
                                    <a class="nav-link" href="#"><!--view-->
                                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16">
                                            <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                                            <path d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>
                                        </svg>
                                    </a>
                                </li>
                            </ul>
                            <div class="row">
                                <div class="col-lg-6 col-md-12 col-sm-12 my-3 p-1 text-center text-secondary">
                                    <p>Payment Status <hr> 
                                        <p>Payment In Silver :<span class="verifyPaymentInSilver"></span>Grm(Fine)</p>
                                        <p>Payment In Cash :<span class="verifyPaymentInCash"></span> Rupees</p>
                                    </p>
                                    <p >
                                        <a style="text-decoration: none;" href="/client/<%=element._id%>/addPayment">
                                        Add Payment
                                        </a>
                                    </p>
                                </div> <hr>
                            </div>
                            <div class="row">
                                <div class="col-lg-12  col-md-12 col-sm-12 my-1 mx-auto p-1 text-secondary text-center">
                                    <p class="my-2">
                                        <a style="text-decoration: none;"  id="clientPurchaseApiLink<%=element._id%>" onclick="getFetchApiPurchase(event)" data-id="<%=element._id%>" role="button" >
                                        View Recent Purchases
                                        </a>
                                    </p>
                                    <!--purchase fetch display design-->
                                    <!--understaning accordian display : the id of the accordian-body is equal to CLIENT ID 
                                    where the fetch data is appended to it 
                                    in fetch we request the fetch with the client data which holds the ref to all its 
                                    transactions purchase/payments/product/sales 
                                            -------------------------------------
                                        the id of the accordian is customised since the accordian will be valid for many entries 
                                        and to prevent id clash they have given a variable which changes with entries therefor
                                        it prevents clashing if Id's pls check the code to understand further-->
                                    <div class="accordion my-2 d-none" id="accordionClientPurchase<%=element._id%>">
                                        <div class="accordion-item">
                                          <h2 class="accordion-header" id="headingPurchase<%=element._id%>">
                                            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapsePurchase<%=element._id%>" aria-expanded="true" aria-controls="collapsePurchase<%=element._id%>">
                                              Purchase List
                                            </button>
                                          </h2>
                                          <div id="collapsePurchase<%=element._id%>" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#accordionClientPurchase<%=element._id%>">
                                            <div class="accordion-body bg-secondary text-light" id=<%=element._id%>>
                                              <!--fetch body data-->
                                              </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-12 col-md-12 col-sm-12 my-1 mx-auto p-1 text-secondary text-center">
                                    <p class="my-2"><a role="button" >View Recent Sales</a></p>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-12 col-md-12 col-sm-12 my-1 mx-auto p-1 text-secondary text-center">
                                    <p class="my-2"><a role="button" >View Recent Payments</a></p>
                                </div>
                            </div>       
                        </div>    
                    </div>
                </div>
            </div>
            <% i=i+1;}})%> <!--closing of if and forEach-->        
        </ul>
    </div>
</div>
<div class="container my-2">
    <li class="list-group-item list-group-item-primary">
        Payment Status Of The Client - Pending/Excess
    </li>
</div>
<div class="container my-1">
    <div class="row">
        <div class="col-12 border-end border-3">
            <ul class="list-group list-group-flush">
                <% clients.forEach((client)=>{ %>
                <li class="list-group-item">
                    <span class="text-capitalize">
                        <%=client.clientName%>
                    </span><br>
                    <span class="text-capitalize">
                        <%=client.paymentStatusCash%>
                    </span><br>
                    <span class="text-capitalize">
                        <%=client.paymentStatusBullion%>
                    </span>
                </li>
                <%})%>
            </ul>
        </div>
    </div><hr>

</div>


<script type="text/javascript" src="/clientViewJS.js"></script>







